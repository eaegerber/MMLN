% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mln_helpers.R
\name{simulate_mixed_mln_data}
\alias{simulate_mixed_mln_data}
\title{simulate_mixed_mln_data: Simulate mixed-effects MLN data with random intercepts}
\usage{
simulate_mixed_mln_data(m, n_i, p, d, beta, Sigma, Phi, PA_mean = 200)
}
\arguments{
\item{m}{Integer. Number of groups.}

\item{n_i}{Integer scalar or vector. Number of observations per group; if scalar, recycled across groups.}

\item{p}{Integer. Number of fixed-effect covariates (including intercept).}

\item{d}{Integer. Number of non-baseline logits (total categories = d + 1).}

\item{beta}{Numeric matrix (p × d). Fixed-effect coefficient matrix.}

\item{Sigma}{Numeric matrix (d × d). Covariance matrix for within-group latent errors.}

\item{Phi}{Numeric matrix (d × d). Covariance matrix for group-level random intercepts.}

\item{PA_mean}{Numeric. Mean of Poisson distribution for total counts per observation (default 200).}
}
\value{
A named list containing:
\describe{
\item{W}{N × (d+1) matrix of simulated counts.}
\item{X}{N × p design matrix for fixed effects.}
\item{Z}{N × m design matrix for random intercepts.}
\item{id}{Integer vector of group identifiers (length N).}
\item{PA}{Integer vector of total counts per observation (length N).}
\item{beta}{Input fixed-effect coefficient matrix.}
\item{Sigma}{Input within-group error covariance matrix.}
\item{Phi}{Input random-intercept covariance matrix.}
}
}
\description{
Generate a dataset from a multinomial logistic-normal (MLN) mixed-effects model with one random intercept per group.
}
\examples{
\dontrun{
sim_data <- simulate_mixed_mln_data(
  m       = 5,
  n_i     = 10,
  p       = 3,
  d       = 2,
  beta    = matrix(c(0.5, -1, 0.2, 0.3, 0.7, -0.4), nrow = 3, ncol = 2),
  Sigma   = diag(2),
  Phi     = diag(c(0.5, 0.5)),
  PA_mean = 150
)
str(sim_data)
}

}
