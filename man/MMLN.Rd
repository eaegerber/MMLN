% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mln_functions.R
\name{MMLN}
\alias{MMLN}
\title{MMLN: Mixed-effects Multinomial Logistic-Normal Gibbs Sampler}
\usage{
MMLN(
  W,
  X,
  Z,
  n_iter = 1000,
  burn_in = 0,
  thin = 1,
  mh_scale = 1,
  prior_settings = NULL,
  verbose = TRUE,
  proposal = "normbeta"
)
}
\arguments{
\item{W}{Numeric matrix (N × (d+1)) of observed counts.}

\item{X}{Numeric matrix (N × p) of fixed-effects covariates.}

\item{Z}{Numeric matrix (N × m) of random-effects design (group indicators).}

\item{n_iter}{Integer. Total MCMC iterations (default 1000).}

\item{burn_in}{Integer. Burn-in iterations to discard (default 0).}

\item{thin}{Integer. Thinning interval (default 1).}

\item{mh_scale}{Numeric. MH proposal scale factor (default 1).}

\item{prior_settings}{List. Prior settings:
\describe{
\item{beta_var}{Prior variance for β.}
\item{nu_S}{Degrees of freedom for Sigma prior.}
\item{Lambda_S}{Scale for Sigma prior.}
\item{nu_P}{Degrees of freedom for Phi prior.}
\item{Lambda_P}{Scale for Phi prior.}
}}

\item{verbose}{Logical. Print progress bar (default TRUE).}

\item{proposal}{Character. One of "norm", "beta", or "normbeta" (default "normbeta").}
}
\value{
A list with:
\describe{
\item{beta_chain}{List of saved fixed-effect β matrices (p × d).}
\item{sigma_chain}{List of saved Sigma matrices (d × d).}
\item{phi_chain}{List of saved Phi matrices (d × d) for random intercepts.}
\item{psi_chain}{List of saved random-intercept matrices (m × d).}
\item{y_chain}{List of latent Y matrices (N × d).}
}
}
\description{
Estimate mixed-effects multinomial logistic-normal models with group-level random intercepts.
}
\examples{
\dontrun{
res_mixed <- MMLN(
  W              = count_matrix,
  X              = fixed_design,
  Z              = random_design,
  n_iter         = 1500,
  burn_in        = 300,
  thin           = 5,
  prior_settings = list(beta_var=5, nu_S=d+1, Lambda_S=I, nu_P=d+1, Lambda_P=I),
  proposal       = "normbeta",
  verbose        = FALSE
)
str(res_mixed)
}

}
